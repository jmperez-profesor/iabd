
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Apuntes y actividades sobre la carga, filtrado y uso, así como la creación de datasets en Hugging Face.">
      
      
      
        <link rel="canonical" href="https://jmperez-profesor.github.io/iabd/Datasets/datasets_aitor/">
      
      
        <link rel="prev" href="../Datasets/">
      
      
        <link rel="next" href="../Actividad1/">
      
      
      <link rel="icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Cargando datasets en HuggingFace (apuntes de Aitor Medrano) - Inteligencia Artificial y Big Data</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cargando-datos" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="https://jmperez-profesor.github.io/iabd/" title="Inteligencia Artificial y Big Data" class="md-header__button md-logo" aria-label="Inteligencia Artificial y Big Data" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Inteligencia Artificial y Big Data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cargando datasets en HuggingFace (apuntes de Aitor Medrano)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="indigo"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Cambiar a modo normal"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo normal" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Introducción

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cloud/sesion1/sesion_cloud_aws/" class="md-tabs__link">
          
  
  
    
  
  Cloud

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../bedrock/sesion1/" class="md-tabs__link">
          
  
  
    
  
  Bedrock

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../hf/" class="md-tabs__link">
          
  
  
    
  
  Hugging Face

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Datasets/" class="md-tabs__link">
          
  
  
    
  
  Datasets

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://jmperez-profesor.github.io/iabd/" title="Inteligencia Artificial y Big Data" class="md-nav__button md-logo" aria-label="Inteligencia Artificial y Big Data" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Inteligencia Artificial y Big Data
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cloud
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sesion1/sesion_cloud_aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sesión 1 Cloud y AWS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Otras
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Otras
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sesion1/reto_migracion_ayuntamiento/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Retro migración ayuntamiento
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sesion1/otras/actividad_ayuntamiento_elche/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto Amazon Q
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sesion1/otras/actividad_cloud_aws_perplexity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto Perplexity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sesion1/otras/sesion1_cloud_aws_copilot_mejorado/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto copilot mejorado
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sesion1/otras/sesion1_cloud_aws_copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto copilot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sesion1/otras/sesion1_cloud_aws_gemini/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto Gemini
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sesion1/otras/sesion1_cloud_aws_proyecto_fenix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto Gemini+NoteBookLM
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bedrock
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Bedrock
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bedrock/sesion1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción a Amazon Bedrock
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../hf/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Hugging Face
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Hugging Face
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/Ejemplo_gradio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gradio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/Tasks_vc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visión por computador
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3_2" >
        
          
          <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Textos (NLP)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            Textos (NLP)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/nlp/01_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/nlp/02_reto1_sentimientos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto1 - Sentimientos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/nlp/soluciones/reto1_solucion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solución Reto1 - Sentimientos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/nlp/03_reto2_clasificacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto2 - Clasificacion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/nlp/soluciones/reto2_solucion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solución Reto2 - Clasificacion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/nlp/04_reto3_generacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reto3 - Generación
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/nlp/soluciones/reto3_solucion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solución Reto3 - Generación
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/Referencias/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Referencias
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Datasets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datasets en Hugging Face
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Cargando datasets en HuggingFace (apuntes de Aitor Medrano)
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Cargando datasets en HuggingFace (apuntes de Aitor Medrano)
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cargando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Cargando datos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cargando datos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#carga-remota" class="md-nav__link">
    <span class="md-ellipsis">
      Carga remota
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dividiendo-el-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Dividiendo el dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cargando-en-pandas" class="md-nav__link">
    <span class="md-ellipsis">
      Cargando en Pandas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cargando-en-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      Cargando en streaming
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limpiando" class="md-nav__link">
    <span class="md-ellipsis">
      Limpiando
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limpiando">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seleccionando-filas" class="md-nav__link">
    <span class="md-ellipsis">
      Seleccionando filas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trabajando-con-columnas" class="md-nav__link">
    <span class="md-ellipsis">
      Trabajando con columnas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trabajando-con-map" class="md-nav__link">
    <span class="md-ellipsis">
      Trabajando con map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trabajando-con-batches" class="md-nav__link">
    <span class="md-ellipsis">
      Trabajando con batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uso-de-pandas" class="md-nav__link">
    <span class="md-ellipsis">
      Uso de Pandas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creando-un-dataset-desde-cero" class="md-nav__link">
    <span class="md-ellipsis">
      Creando un dataset desde cero
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#persistiendo" class="md-nav__link">
    <span class="md-ellipsis">
      Persistiendo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publicando" class="md-nav__link">
    <span class="md-ellipsis">
      Publicando
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datasets-multimedia" class="md-nav__link">
    <span class="md-ellipsis">
      Datasets multimedia
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Datasets multimedia">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#audios" class="md-nav__link">
    <span class="md-ellipsis">
      Audios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creando-un-dataset-desde-python" class="md-nav__link">
    <span class="md-ellipsis">
      Creando un dataset desde Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audiofolder" class="md-nav__link">
    <span class="md-ellipsis">
      Audiofolder
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades" class="md-nav__link">
    <span class="md-ellipsis">
      Actividades
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Actividades
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Actividades
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Actividad1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actividad 1 - Datasets de Hugging Face
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Cargando datasets en HuggingFace (apuntes de Aitor Medrano)</h1>

<p>Ya hemos visto que podemos utilizar diferentes <em>datasets</em> existentes en la plataforma para re-entrenar nuestros modelos.</p>
<p>En esta sesión vamos a estudiar cómo crear un <em>dataset</em> a partir de nuestros datos, limpiar un <em>dataset</em>, a reducirlo para que quepa en RAM y como tras crear nuestro <em>dataset</em>, subirlo al <em>Hub</em>.</p>
<h2 id="cargando-datos">Cargando datos</h2>
<p>Para cargar datos, haremos uso de la función <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/loading_methods#datasets.load_dataset"><code>load_dataset()</code></a> de la librería <a href="https://huggingface.co/docs/datasets/index"><em>Datasets</em></a>. Si fuera necesaria instalarla, mediante <code>pip</code> haríamos:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>datasets
</code></pre></div>
<p>Podemos cargar archivos con diferentes formatos indicando el formato y los datos:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># CSV &amp; TSV</span>
<span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;mis_datos.csv&quot;</span><span class="p">)</span>
<span class="c1"># Texto</span>
<span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;mis_datos.txt&quot;</span><span class="p">)</span>
<span class="c1"># JSON &amp; JSONL</span>
<span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;mis_datos.jsonl&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Para este apartado nos vamos a centrar en los datos de SQuAD (<em>Stanford Question Answering Dataset</em>), compuesto de un conjunto de artículos de <em>Wikipedia</em>, con respuestas a diferentes preguntas sobre los artículos. En nuestro caso, nos vamos a centrar en una versión en castellano que podemos ver en <a href="https://huggingface.co/datasets/squad_es">https://huggingface.co/datasets/squad_es</a> o descargarlo de desde <a href="https://github.com/ccasimiro88/TranslateAlignRetrieve/tree/master/SQuAD-es-v2.0">https://github.com/ccasimiro88/TranslateAlignRetrieve/tree/master/SQuAD-es-v2.0</a>.</p>
<p>Si descargamos los archivos y los colocamos en la misma carpeta que el siguiente <em>script</em>, podemos realizar una carga local de los datos:</p>
<div class="highlight"><span class="filename">squad-es-local.py</span><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>

<span class="hll"><span class="n">squad_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;train-v2.0-es.json&quot;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squad_dataset</span><span class="p">)</span>
</code></pre></div>
<p>Tras ejecutarlo, nos muestra que al cargar el <em>dataset</em> ha creado un <em>split</em> para <em>train</em>, con la cantidad de filas y las columnas contenidas dentro de un <a href="https://huggingface.co/docs/datasets/package_reference/main_classes#datasets.DatasetDict"><code>DatasetDict</code></a>:</p>
<div class="highlight"><pre><span></span><code>Generating<span class="w"> </span>train<span class="w"> </span>split:<span class="w"> </span><span class="m">442</span><span class="w"> </span>examples<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00,<span class="w"> </span><span class="m">1211</span>.02<span class="w"> </span>examples/s<span class="o">]</span>
DatasetDict<span class="o">({</span>
<span class="w">    </span>train:<span class="w"> </span>Dataset<span class="o">({</span>
<span class="w">        </span>features:<span class="w"> </span><span class="o">[</span><span class="s1">&#39;title&#39;</span>,<span class="w"> </span><span class="s1">&#39;paragraphs&#39;</span><span class="o">]</span>,
<span class="w">        </span>num_rows:<span class="w"> </span><span class="m">442</span>
<span class="w">    </span><span class="o">})</span>
<span class="o">})</span>
</code></pre></div>
<p>Si queremos obtener más información, podemos mostrar las características:</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">squad_dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>
</span><span class="c1"># {&#39;title&#39;: Value(dtype=&#39;string&#39;, id=None),</span>
<span class="c1">#  &#39;paragraphs&#39;: [</span>
<span class="c1">#     {&#39;context&#39;: Value(dtype=&#39;string&#39;, id=None),</span>
<span class="c1">#      &#39;qas&#39;: [</span>
<span class="c1">#         {&#39;answers&#39;: [{&#39;answer_start&#39;: Value(dtype=&#39;int64&#39;, id=None), &#39;text&#39;: Value(dtype=&#39;string&#39;, id=None)}],</span>
<span class="c1">#          &#39;id&#39;: Value(dtype=&#39;string&#39;, id=None),</span>
<span class="c1">#          &#39;is_impossible&#39;: Value(dtype=&#39;bool&#39;, id=None),</span>
<span class="c1">#          &#39;plausible_answers&#39;: [{&#39;answer_start&#39;: Value(dtype=&#39;int64&#39;, id=None), &#39;text&#39;: Value(dtype=&#39;string&#39;, id=None)}],</span>
<span class="c1">#          &#39;question&#39;: Value(dtype=&#39;string&#39;, id=None)}]</span>
<span class="c1">#     }</span>
<span class="c1">#  ]</span>
<span class="c1"># }</span>
</code></pre></div>
<p>Y al tratarse de un diccionario, podemos navegar mediante los corchetes para, por ejemplo, recuperar parte de los datos:</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">squad_dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
</span><span class="c1"># Beyoncé Knowles</span>
<span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">squad_dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;paragraphs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span class="c1"># {&#39;context&#39;: &#39;Beyoncé Giselle Knowles-Carter (nacida el 4 de septiembre de 1981)..&#39;,</span>
 <span class="c1"># &#39;qas&#39;: [</span>
    <span class="c1"># {&#39;answers&#39;: [{&#39;answer_start&#39;: 246, &#39;text&#39;: &#39;a finales de 1990&#39;}],</span>
    <span class="c1">#  &#39;id&#39;: &#39;56be85543aeaaa14008c9063&#39;, &#39;is_impossible&#39;: False, &#39;plausible_answers&#39;: None, &#39;question&#39;: &#39;¿Cuándo Beyonce comenzó a ser popular?&#39;},</span>
    <span class="c1"># {&#39;answers&#39;: ...</span>
</code></pre></div>
<p>Cuando cargamos un <em>dataset</em>, realmente queremos cargar los datos de entrenamiento y los de validación. Para ello, le pasaremos un diccionario con los diferentes archivos para <code>train</code> y para <code>val</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">ficheros_datos</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="s2">&quot;train-v2.0-es.json&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="s2">&quot;dev-v2.0-es.json&quot;</span><span class="p">}</span>
<span class="n">squad_dataset_train</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">ficheros_datos</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Obteniendo:</p>
<div class="highlight"><pre><span></span><code><span class="n">DatasetDict</span><span class="p">({</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">({</span>
        <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;paragraphs&#39;</span><span class="p">],</span>
        <span class="n">num_rows</span><span class="p">:</span> <span class="mi">442</span>
    <span class="p">})</span>
    <span class="n">val</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">({</span>
        <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;paragraphs&#39;</span><span class="p">],</span>
        <span class="n">num_rows</span><span class="p">:</span> <span class="mi">35</span>
    <span class="p">})</span>
<span class="p">})</span>
</code></pre></div>
<p>Si queremos cargar únicamente una de las partes, le pasaremos el parámetro <code>split</code> con el valor deseado:</p>
<div class="highlight"><pre><span></span><code><span class="n">ficheros_datos</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="s2">&quot;train-v2.0-es.json&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="s2">&quot;dev-v2.0-es.json&quot;</span><span class="p">}</span>
<span class="n">squad_dataset_train</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">ficheros_datos</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squad_dataset_train</span><span class="p">)</span>
</code></pre></div>
<p>Si el <em>dataset</em> está en un archivo comprimido en <em>gzip</em>, <em>zip</em> o <em>tar</em>, la librería descomprimirá los datos automáticamente:</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="n">ficheros_datos</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="s2">&quot;train-v2.0-es.json.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="s2">&quot;dev-v2.0-es.json.zip&quot;</span><span class="p">}</span>
</span><span class="n">squad_dataset_trainval</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">ficheros_datos</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squad_dataset_trainval</span><span class="p">)</span>
</code></pre></div>
<h3 id="carga-remota">Carga remota</h3>
<p>Si el <em>dataset</em> está almacenado en una URL remota, podemos cargarlos directamente:</p>
<div class="highlight"><span class="filename">squad-es-remoto.py</span><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/ccasimiro88/TranslateAlignRetrieve/master/SQuAD-es-v2.0/&quot;</span>

<span class="n">ficheros_datos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;train-v2.0-es.json&quot;</span><span class="p">,</span>
    <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;dev-v2.0-es.json&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">squad_remote_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">ficheros_datos</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">squad_remote_dataset</span><span class="p">)</span>
</code></pre></div>
<h3 id="dividiendo-el-dataset">Dividiendo el dataset</h3>
<p>Si en vez de cargar por separado los datos de entrenamiento y los de test, tenemos un único conjunto de datos, podemos dividirlo mediante el método <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/main_classes#datasets.Dataset.train_test_split"><code>Dataset.train_test_split()</code></a> indicando el tamaño, por ejemplo, de los datos de test:</p>
<div class="highlight"><span class="filename">squad-es-split.py</span><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">squad_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;train-v2.0-es.json&quot;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="hll"><span class="n">squad_split_dataset</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span class="nb">print</span><span class="p">(</span><span class="n">squad_split_dataset</span><span class="p">)</span>
</code></pre></div>
<p>De manera que pasamos de un dataset de 442 filas a uno dividido en 397 para entrenamiento y 45 para test:</p>
<div class="highlight"><pre><span></span><code><span class="n">DatasetDict</span><span class="p">({</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">({</span>
        <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;paragraphs&#39;</span><span class="p">],</span>
        <span class="n">num_rows</span><span class="p">:</span> <span class="mi">397</span>
    <span class="p">})</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">({</span>
        <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;paragraphs&#39;</span><span class="p">],</span>
        <span class="n">num_rows</span><span class="p">:</span> <span class="mi">45</span>
    <span class="p">})</span>
<span class="p">})</span>
</code></pre></div>
<h3 id="cargando-en-pandas">Cargando en Pandas</h3>
<p>Si estamos trabajando con <em>Pandas</em> y queremos cargar un archivo que está en un <em>dataset</em> de <em>Hugging Face</em>, podemos utilizar la librería de <code>huggingface_hub</code> para crear, eliminar, actualizar y recuperar información de los repositorios.</p>
<p>Por ejemplo, para cargar un dataset CSV con Pandas podríamos hacer:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">huggingface_hub</span><span class="w"> </span><span class="kn">import</span> <span class="n">hf_hub_download</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">REPO_ID</span> <span class="o">=</span> <span class="s2">&quot;aitor-medrano/iabd&quot;</span>
<span class="n">FICHERO</span> <span class="o">=</span> <span class="s2">&quot;cp_train.csv&quot;</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="hll">    <span class="n">hf_hub_download</span><span class="p">(</span><span class="n">repo_id</span><span class="o">=</span><span class="n">REPO_ID</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">FICHERO</span><span class="p">,</span> <span class="n">repo_type</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="c1"># &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="c1"># RangeIndex: 3214 entries, 0 to 3213</span>
<span class="c1"># Data columns (total 3 columns):</span>
<span class="c1">#  #   Column   Non-Null Count  Dtype  </span>
<span class="c1"># ---  ------   --------------  -----  </span>
<span class="c1">#  0   formula  3214 non-null   object </span>
<span class="c1">#  1   T        3214 non-null   float64</span>
<span class="c1">#  2   Cp       3214 non-null   float64</span>
<span class="c1"># dtypes: float64(2), object(1)</span>
<span class="c1"># memory usage: 75.5+ KB</span>
</code></pre></div>
<h3 id="cargando-en-streaming">Cargando en streaming</h3>
<p>Si el <em>dataset</em> ocupa varios gigas, con modelos como BERT o GPT, puede que no quepan en memoria RAM. Para ello, la librería <em>datasets</em> gestiona los datos como ficheros mapeados en memoria realizando un <a href="https://huggingface.co/docs/datasets/stream"><em>streaming</em></a> de los datos.</p>
<figure style="align: center;">
    <img src="https://aitor-medrano.github.io/iabd/hf/images/03hf-streaming.gif" alt="Streaming de un dataset" width="800px">
    <figcaption>Streaming de un dataset - https://huggingface.co/docs/datasets/stream</figcaption>
</figure>

<p>Para este apartado, vamos a utilizar parte de un dataset con código encontrado en <em>GitHub</em> de los diferentes lenguajes de programación, conocido como <a href="https://huggingface.co/datasets/bigcode/the-stack-v2">BigCode</a>.</p>
<div class="admonition info">
<p class="admonition-title">Gated dataset</p>
<p>El <em>dataset</em> de <em>BigCode</em> está configurado para pedir las credenciales de los usuarios que los utilizan. Esto se conoce como un <a href="https://huggingface.co/docs/hub/datasets-gated">Gated dataset</a>. Es por ello que tenemos que hacer login en <em>Hugging Face</em> antes de poder descargarlo.</p>
</div>
<p>En nuestro caso, nos vamos a centrar en archivos <code>DockerFile</code> para que el dataset sea asumible (alrededor de 1Gb). Así pues, cargamos los datos:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">bigcode_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;bigcode/the-stack-v2&quot;</span><span class="p">,</span> <span class="s2">&quot;Dockerfile&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bigcode_dataset</span><span class="p">)</span>
<span class="c1"># Dataset({</span>
<span class="c1">#     features: [&#39;blob_id&#39;, &#39;directory_id&#39;, &#39;path&#39;, &#39;content_id&#39;, &#39;detected_licenses&#39;, &#39;license_type&#39;, &#39;repo_name&#39;, &#39;snapshot_id&#39;, &#39;revision_id&#39;, &#39;branch_name&#39;, &#39;visit_date&#39;, &#39;revision_date&#39;, &#39;committer_date&#39;, &#39;github_id&#39;, &#39;star_events_count&#39;, &#39;fork_events_count&#39;, &#39;gha_license_id&#39;, &#39;gha_event_created_at&#39;, &#39;gha_created_at&#39;, &#39;gha_language&#39;, &#39;src_encoding&#39;, &#39;language&#39;, &#39;is_vendor&#39;, &#39;is_generated&#39;, &#39;length_bytes&#39;, &#39;extension&#39;],</span>
<span class="c1">#     num_rows: 4155925</span>
<span class="c1"># })</span>
</code></pre></div>
<p>Y el contenido de un documento:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;blob_id&quot;</span><span class="p">:</span><span class="s2">&quot;a29dd2b33082d2b98541c66ba3620ae054991503&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;directory_id&quot;</span><span class="p">:</span><span class="s2">&quot;71568d223947f51cb007a8564e5f808e0987779e&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;/src/Dapr/GameServer.Host/Dockerfile&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;content_id&quot;</span><span class="p">:</span><span class="s2">&quot;072b3138be512a71cf4e8bbbdb657497e808d2f6&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;detected_licenses&quot;</span><span class="p">:[</span>
<span class="w">      </span><span class="s2">&quot;MIT&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;LicenseRef-scancode-unknown-license-reference&quot;</span>
<span class="w">   </span><span class="p">],</span>
<span class="w">   </span><span class="nt">&quot;license_type&quot;</span><span class="p">:</span><span class="s2">&quot;permissive&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;repo_name&quot;</span><span class="p">:</span><span class="s2">&quot;devblack/OpenMU&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;snapshot_id&quot;</span><span class="p">:</span><span class="s2">&quot;8cdc521178da47c9c7d2daa502dc71688835fd0a&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;revision_id&quot;</span><span class="p">:</span><span class="s2">&quot;1064b0dca1a491bc28f325e42ca6b97d406d6558&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;branch_name&quot;</span><span class="p">:</span><span class="s2">&quot;refs/heads/master&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;visit_date&quot;</span><span class="p">:</span><span class="err">Times</span><span class="kc">ta</span><span class="err">mp(</span><span class="s2">&quot;2023-04-07 10:56:30.043316&quot;</span><span class="err">)</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;revision_date&quot;</span><span class="p">:</span><span class="err">Times</span><span class="kc">ta</span><span class="err">mp(</span><span class="s2">&quot;2023-03-17 20:32:25&quot;</span><span class="err">)</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;committer_date&quot;</span><span class="p">:</span><span class="err">Times</span><span class="kc">ta</span><span class="err">mp(</span><span class="s2">&quot;2023-03-17 20:32:25&quot;</span><span class="err">)</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;github_id&quot;</span><span class="p">:</span><span class="err">No</span><span class="kc">ne</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;star_events_count&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;fork_events_count&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;gha_license_id&quot;</span><span class="p">:</span><span class="err">No</span><span class="kc">ne</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;gha_event_created_at&quot;</span><span class="p">:</span><span class="err">No</span><span class="kc">ne</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;gha_created_at&quot;</span><span class="p">:</span><span class="err">No</span><span class="kc">ne</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;gha_language&quot;</span><span class="p">:</span><span class="err">No</span><span class="kc">ne</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;src_encoding&quot;</span><span class="p">:</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="s2">&quot;Dockerfile&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;is_vendor&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;is_generated&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;length_bytes&quot;</span><span class="p">:</span><span class="mi">709</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;extension&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>Si ahora cargamos el <em>dataset</em> mediante <em>streaming</em>, pasándole el parámetros <code>streaming=True</code>, en vez de recuperar un Dataset, obtendremos un <code>IterableDataset</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">streaming_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;bigcode/the-stack-v2&quot;</span><span class="p">,</span> <span class="s2">&quot;Dockerfile&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">streaming_dataset</span><span class="p">)</span>
<span class="c1"># Resolving data files: 100%|█████████████████████████████████████████████████| 976/976 [00:00&lt;00:00, 1064.36it/s]</span>
<span class="c1"># IterableDataset({</span>
<span class="c1">#     features: [&#39;blob_id&#39;, &#39;directory_id&#39;, &#39;path&#39;, &#39;content_id&#39;, &#39;detected_licenses&#39;, &#39;license_type&#39;, &#39;repo_name&#39;, &#39;snapshot_id&#39;, &#39;revision_id&#39;, &#39;branch_name&#39;, &#39;visit_date&#39;, &#39;revision_date&#39;, &#39;committer_date&#39;, &#39;github_id&#39;, &#39;star_events_count&#39;, &#39;fork_events_count&#39;, &#39;gha_license_id&#39;, &#39;gha_event_created_at&#39;, &#39;gha_created_at&#39;, &#39;gha_language&#39;, &#39;src_encoding&#39;, &#39;language&#39;, &#39;is_vendor&#39;, &#39;is_generated&#39;, &#39;length_bytes&#39;, &#39;extension&#39;],</span>
<span class="c1">#     n_shards: 1</span>
<span class="c1"># })</span>
</code></pre></div>
<p>Como sugiere el nombre, para acceder a los elementos del <code>IterableDataset</code> necesitamos iterar sobre él:</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">streaming_dataset</span><span class="p">)))</span>
</code></pre></div>
<p>Los elementos de un <em>dataset</em> en <em>streaming</em>  se pueden procesar al vuelo mediante la función <code>map</code> o <code>filter</code>. Por ejemplo, para pasar a mayúsculas el campo <code>license_type</code> haríamos:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mayusLicencias</span><span class="p">(</span><span class="n">registro</span><span class="p">):</span>
    <span class="n">registro</span><span class="p">[</span><span class="s2">&quot;license_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">registro</span><span class="p">[</span><span class="s2">&quot;license_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">registro</span>

<span class="n">mapped_dataset</span> <span class="o">=</span> <span class="n">streaming_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mayusLicencias</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">streaming_dataset</span><span class="p">)))</span>
<span class="c1"># ... &#39;detected_licenses&#39;: [&#39;MIT&#39;, ...], &#39;license_type&#39;: &#39;PERMISSIVE&#39;, &#39;repo_name&#39;: &#39;devblack/OpenMU&#39; ...</span>
</code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Al vuelo</p>
<p>Debemos tener en cuenta que la transformación se realizará al recorrer el <em>dataset</em>, no al invocar a los métodos <code>map</code> o <code>filter</code>.</p>
</div>
<p>Otras opciones son utilizar las operaciones <a href="https://huggingface.co/docs/datasets/main/en/package_reference/main_classes#datasets.IterableDataset.take"><code>take()</code></a>, <a href="https://huggingface.co/docs/datasets/v4.4.1/en/package_reference/main_classes#datasets.IterableDataset.shuffle"><code>shuffle()</code></a> o <a href="https://huggingface.co/docs/datasets/v4.4.1/en/package_reference/main_classes#datasets.IterableDataset.shuffle"><code>skip()</code></a> dentro del <code>IterableDataset</code> para trabajar con muestras pequeñas de los datos cargados:</p>
<div class="highlight"><pre><span></span><code><span class="n">muestra</span> <span class="o">=</span> <span class="n">streaming_dataset</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">muestra_aleatoria</span> <span class="o">=</span> <span class="n">streaming_dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="n">rango</span> <span class="o">=</span> <span class="n">streaming_dataset</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<p>Más información en <a href="https://huggingface.co/docs/datasets/stream">https://huggingface.co/docs/datasets/stream</a> y <a href="https://huggingface.co/docs/datasets/about_mapstyle_vs_iterable">https://huggingface.co/docs/datasets/about_mapstyle_vs_iterable</a>.</p>
<h2 id="limpiando">Limpiando</h2>
<p>De forma similar a <em>Pandas</em> o <em>Spark</em>, podemos manipular el contenido de los objetos <code>Dataset</code>.</p>
<p>El primer paso debería ser barajar los datos para <em>desordenarlos</em> y coger una muestra. Para ello, emplearemos <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/main_classes#datasets.Dataset.shuffle"><code>Dataset.shuffle()</code></a>:</p>
<div class="highlight"><pre><span></span><code><span class="n">squad_train</span> <span class="o">=</span> <span class="n">squad_dataset_trainval</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squad_train</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">])</span> <span class="c1"># Beyoncé Knowles</span>

<span class="hll"><span class="n">squad_train_shuffled</span> <span class="o">=</span> <span class="n">squad_train</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">333</span><span class="p">)</span>
</span><span class="nb">print</span><span class="p">(</span><span class="n">squad_train_shuffled</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">])</span> <span class="c1"># Carnaval</span>
</code></pre></div>
<h3 id="seleccionando-filas">Seleccionando filas</h3>
<p>Para recuperar filas, usaremos el método <code>Dataset.select()</code> pasándole un iterador con las posiciones a seleccionar:</p>
<div class="highlight"><pre><span></span><code><span class="n">tres_filas</span> <span class="o">=</span> <span class="n">squad_train_shuffled</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
<span class="n">seis_filas</span> <span class="o">=</span> <span class="n">squad_train_shuffled</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
</code></pre></div>
<p>Si queremos seleccionar las filas por algún criterio específico, debemos emplear <code>Dataset.filter()</code> y funciones <em>lambda</em>:</p>
<div class="highlight"><pre><span></span><code><span class="n">empieza_por_b_filas</span> <span class="o">=</span> <span class="n">squad_train_shuffled</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">empieza_por_b_filas</span><span class="o">.</span><span class="n">num_rows</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">empieza_por_b_filas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
<span class="c1"># Beidou _ Navigation _ Satellite _ System (en inglés)</span>
<span class="c1"># Biodiversidad</span>
<span class="c1"># Boston ...</span>
</code></pre></div>
<h3 id="trabajando-con-columnas">Trabajando con columnas</h3>
<p>Al trabajar con columnas, podemos añadir una nueva mediante <code>Dataset.add_column()</code>, cambiarles el nombre con <code>DatasetDict.rename_column()</code> o eliminar una columna con <code>DatasetDict.remove_column()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">nueva_columna</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nueva&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">squad_train_shuffled</span><span class="o">.</span><span class="n">num_rows</span>
<span class="hll"><span class="n">squad_train_shuffled</span> <span class="o">=</span> <span class="n">squad_train_shuffled</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;inicial&quot;</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="n">nueva_columna</span><span class="p">)</span>
</span><span class="c1"># Dataset({</span>
<span class="c1">#     features: [&#39;title&#39;, &#39;paragraphs&#39;, &#39;inicial&#39;],</span>
<span class="c1">#     num_rows: 442</span>
<span class="c1"># })</span>
<span class="hll"><span class="n">squad_train_shuffled</span> <span class="o">=</span> <span class="n">squad_train_shuffled</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span>
</span><span class="hll">    <span class="n">original_column_name</span><span class="o">=</span><span class="s2">&quot;inicial&quot;</span><span class="p">,</span> <span class="n">new_column_name</span><span class="o">=</span><span class="s2">&quot;modificada&quot;</span>
</span><span class="p">)</span>
<span class="c1"># Dataset({</span>
<span class="c1">#     features: [&#39;title&#39;, &#39;paragraphs&#39;, &#39;modificada&#39;],</span>
<span class="c1">#     num_rows: 442</span>
<span class="c1"># })</span>
<span class="hll"><span class="n">squad_train_shuffled</span> <span class="o">=</span> <span class="n">squad_train_shuffled</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">([</span><span class="s2">&quot;modificada&quot;</span><span class="p">])</span>
</span><span class="c1"># Dataset({</span>
<span class="c1">#     features: [&#39;title&#39;, &#39;paragraphs&#39;],</span>
<span class="c1">#     num_rows: 442</span>
<span class="c1"># })</span>
</code></pre></div>
<h3 id="trabajando-con-map">Trabajando con map</h3>
<p>Y la joya de la corona es la función <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/main_classes#datasets.Dataset.map"><code>Dataset.map()</code></a> para aplicar una transformación a medida.
Por ejemplo, si queremos modificar todos los títulos y pasarlos a minúscula haremos:</p>
<div class="highlight"><span class="filename">squad-map.py</span><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">ficheros_datos</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="s2">&quot;train-v2.0-es.json&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;dev-v2.0-es.json&quot;</span><span class="p">}</span>
<span class="n">squad_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">ficheros_datos</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">squad_dataset</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">titulo_minus</span><span class="p">(</span><span class="n">registro</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="n">registro</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()}</span>

<span class="n">squad_minus</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">titulo_minus</span><span class="p">)</span>

<span class="c1"># Mostramos 5 elementos</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squad_minus</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">987</span><span class="p">)[</span><span class="s2">&quot;title&quot;</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span>
<span class="c1"># [&#39;marshall&#39;, &#39;ascensor&#39;, &#39;kanye&#39;, &#39;bbc televisión&#39;, &#39;florida&#39;]</span>
</code></pre></div>
<p>Mediante la función <code>map</code> también podemos crear nuevas columnas a partir de los valores de otras. Por ejemplo, añadimos una nueva característica con la cantidad de párrafos y quitamos toda la información existente previamente de los párrafos:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Añadimos nueva columna</span>
<span class="n">squad_col_num_parrafos</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;num_paragraphs&quot;</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;paragraphs&quot;</span><span class="p">])})</span>
<span class="c1"># Borramos la antigua</span>
<span class="n">squad_col_num_parrafos</span> <span class="o">=</span> <span class="n">squad_col_num_parrafos</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="s2">&quot;paragraphs&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squad_col_num_parrafos</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">987</span><span class="p">)[:</span><span class="mi">5</span><span class="p">])</span>
<span class="c1"># {&#39;title&#39;: [&#39;Marshall&#39;, &#39;Ascensor&#39;, &#39;Kanye&#39;, &#39;BBC Televisión&#39;, &#39;Florida&#39;], &#39;num_paragraphs&#39;: [51, 52, 79, 31, 35]}</span>
</code></pre></div>
<p>¿Y si queremos ordenar los párrafos por la cantidad de párrafos? Para ello, podemos utilizar <code>Dataset.sort()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">squad_num_parrafos_ordenados</span> <span class="o">=</span> <span class="n">squad_col_num_parrafos</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;num_paragraphs&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">squad_num_parrafos_ordenados</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># tres primeros</span>
<span class="c1"># {&#39;title&#39;: [&#39;Tono _ (música)&#39;, &#39;Uva&#39;, &#39;Letra _ case&#39;], &#39;num_paragraphs&#39;: [10, 10, 12]}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">squad_num_parrafos_ordenados</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span> <span class="c1"># tres últimos</span>
<span class="c1"># {&#39;title&#39;: [&#39;American Idol (en inglés).&#39;, &#39;Nueva York&#39;, &#39;Budismo&#39;], &#39;num_paragraphs&#39;: [127, 148, 149]}</span>
</code></pre></div>
<h3 id="trabajando-con-batches">Trabajando con <em>batches</em></h3>
<p>El método <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/main_classes#datasets.Dataset.map"><code>Dataset.map()</code></a> admite el argumento <code>batched</code> que, si se establece en <code>True</code>, hace que envíe un lote de datos a la función <code>map</code> a la vez (el tamaño del lote es configurable mediante el parámetro <code>batch_size</code>, pero por defecto es de 1000). Al indicar <code>batched=True</code>, la función <code>map</code> recibe un diccionario con los campos del conjunto de datos, pero cada valor es ahora una lista de valores, y no un único valor, y del mismo modo, devuelve un diccionario con los campos que queremos actualizar o añadir a nuestro conjunto de datos, y una lista de valores.</p>
<p>Por ello, debemos modificar la función que realiza el <code>map</code> para que trabaje con un diccionario de listas.</p>
<p>Para el siguiente ejemplo, vamos a coger el <em>dataset</em> de <em>SQuAD_es</em> desde <em>Hugging Face</em> que contiene más datos, y vamos a comparar el tiempo de ejecución, recodificando la función para trabajar con un diccionario que contiene una lista por cada campo:</p>
<div class="highlight"><span class="filename">squad-map-batch.py</span><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># Cargamos el dataset desde HF</span>
<span class="n">squad_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;squad_es&quot;</span><span class="p">,</span> <span class="s2">&quot;v2.0.0&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>  <span class="c1"># (1)!</span>

<span class="k">def</span><span class="w"> </span><span class="nf">titulo_minus</span><span class="p">(</span><span class="n">registro</span><span class="p">):</span>
<span class="hll">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="n">registro</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()}</span>
</span>
<span class="n">inicio</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="hll"><span class="n">squad_minus</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">titulo_minus</span><span class="p">)</span> <span class="c1"># (2)!</span>
</span><span class="c1"># Map: 100%|██████| 11858/11858 [00:00&lt;00:00, 37926.07 examples/s]   </span>
<span class="n">fin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fin</span> <span class="o">-</span> <span class="n">inicio</span><span class="p">)</span> <span class="c1"># 3.008699893951416</span>

<span class="hll"><span class="k">def</span><span class="w"> </span><span class="nf">titulo_minus_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
</span><span class="hll">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:[</span><span class="n">titulo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">titulo</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]]}</span>
</span>
<span class="n">inicio</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="hll"><span class="n">squad_minus</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">titulo_minus_batch</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># (3)!</span>
</span><span class="c1"># Map: 100%|██████| 11858/11858 [00:00&lt;00:00, 535210.67 examples/s]</span>
<span class="n">fin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fin</span> <span class="o">-</span> <span class="n">inicio</span><span class="p">)</span> <span class="c1"># 0.19133710861206055</span>
</code></pre></div>
<ol>
<li>Cargamos los datos desde el dataset de <em>Hugging Face</em></li>
<li>El mapper normal realiza casi 40.000 registros por segundo</li>
<li>Al hacerlo con batches realiza más de 500.000 por segundo</li>
</ol>
<h3 id="uso-de-pandas">Uso de Pandas</h3>
<p>Para facilitar la conversión entre diferentes formados, podemos usar el método <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/main_classes#datasets.Dataset.set_format"><code>Dataset.set_format()</code></a> para modificar el formato de salida (por ejemplo, a <code>pandas</code>, <code>numpy</code>, <code>torch</code>, <code>tensorflow</code>, <code>jax</code>, ...), sin modificar el formato original del dataset (el cual es <em>Apache Arrow</em> - <code>arrow</code>).</p>
<p>Así, si por ejemplo queremos pasar los datos a <em>Pandas</em> para trabajar con ellos, transformarlos o visualizarlos, podemos hacer:</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">squad_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">squad_dataset</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="s2">&quot;pandas&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="p">[:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># (130313, 5)</span>

<span class="c1"># Otra forma</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="c1"># &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="c1"># RangeIndex: 130313 entries, 0 to 130312</span>
<span class="c1"># Data columns (total 5 columns):</span>
<span class="c1">#  #   Column    Non-Null Count   Dtype </span>
<span class="c1"># ---  ------    --------------   ----- </span>
<span class="c1">#  0   id        130313 non-null  object</span>
<span class="c1">#  1   title     130313 non-null  object</span>
<span class="c1">#  2   context   130313 non-null  object</span>
<span class="c1">#  3   question  130313 non-null  object</span>
<span class="c1">#  4   answers   130313 non-null  object</span>
<span class="c1"># dtypes: object(5)</span>
<span class="c1"># memory usage: 5.0+ MB</span>

<span class="c1"># Y realizar consultas sobre los datos, por ejemplo, la 5 preguntas con más respuestas</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">)[</span><span class="s2">&quot;answers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="c1"># title</span>
<span class="c1"># Reina                         883</span>
<span class="c1"># Nueva York                    817</span>
<span class="c1"># American Idol (en inglés).    790</span>
<span class="c1"># Beyoncé Knowles               753</span>
<span class="c1"># Universidad                   738</span>
</code></pre></div>
<p>Y para volver a tener un objeto <code>Dataset</code>, podemos utilizar el método <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/main_classes#datasets.Dataset.from_pandas"><code>Dataset.from_pandas()</code></a> o resetear el <em>dataset</em> que teníamos mediante <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/main_classes#datasets.Dataset.reset_format"><code>Dataset.reset_format()</code></a>:</p>
<div class="highlight"><pre><span></span><code><span class="n">squad_transformed</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">squad_original</span> <span class="o">=</span> <span class="n">squad_dataset</span><span class="o">.</span><span class="n">reset_format</span><span class="p">()</span>
</code></pre></div>
<h2 id="creando-un-dataset-desde-cero">Creando un dataset desde cero</h2>
<p>Si en vez de cargar un <em>dataset</em>, tenemos que crear uno, el primer paso será obtener los datos.</p>
<p>Ya sea mediante peticiones a URL externas con la librería <code>request</code>, accediendo a bases de datos relacionales, por ejemplo, mediante <em>SQLAlchemy</em> o a <em>MongoDB</em> mediante <code>PyMongo</code>, lo más normal es crear una estructura de datos mediante una lista o un diccionario y luego crear el <em>dataset</em> a partir del mismo.</p>
<p>Así pues, si en vez de cargar un <em>dataset</em> queremos crear uno desde cero, podemos hacer uso de <code>Dataset.from_dict()</code> o <code>Dataset.from_list()</code> dependiendo de donde tengamos los datos. Por ejemplo, vamos a conectarnos a <em>MongoDB</em> y creamos una lista con todos los datos. A partir de la lista, generamos un <em>Dataset</em>:</p>
<div class="highlight"><span class="filename">dataset-mongodb.py</span><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymongo</span><span class="w"> </span><span class="kn">import</span> <span class="n">MongoClient</span>

<span class="n">cliente</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="s1">&#39;mongodb+srv://iabd:iabdiabd@cluster0.dfaz5er.mongodb.net&#39;</span><span class="p">)</span>

<span class="c1"># Vamos a trabajar con la colección grades de sample_training</span>
<span class="n">iabd_db</span> <span class="o">=</span> <span class="n">cliente</span><span class="o">.</span><span class="n">sample_training</span>
<span class="n">grades_coll</span> <span class="o">=</span> <span class="n">iabd_db</span><span class="o">.</span><span class="n">grades</span>

<span class="c1"># Creamos un dataset vacío mediante una lista</span>
<span class="n">documentos</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Recuperamos todas las calificaciones</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">grades_coll</span><span class="o">.</span><span class="n">find</span><span class="p">({})</span>
<span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">cursor</span><span class="p">:</span>
  <span class="k">del</span> <span class="n">document</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">]</span>  <span class="c1"># Quitamos el ObjectId</span>
  <span class="n">documentos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>

<span class="n">mongo_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">documentos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mongo_dataset</span><span class="p">)</span>
<span class="c1"># Dataset({</span>
<span class="c1">#     features: [&#39;student_id&#39;, &#39;scores&#39;, &#39;class_id&#39;],</span>
<span class="c1">#     num_rows: 100000</span>
<span class="c1"># })</span>
</code></pre></div>
<p>O si queremos almacenar los datos de forma temporal, por ejemplo, podemos hacer uso de <em>Pandas</em>:</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">documentos</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;grades-docs.jsonl&quot;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">jsonl_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;grades-docs.jsonl&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="persistiendo">Persistiendo</h2>
<p>Cuando cargamos un <em>dataset</em> se cachean los datos para evitar tener que descargar los datos de forma remota y crear las tablas de <em>PyArrow</em>. Podemos averiguar donde se almacenan los datos mediante la propiedad <code>cache_files</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">ficheros_datos</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="s2">&quot;train-v2.0-es.json&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;dev-v2.0-es.json&quot;</span><span class="p">}</span>
<span class="n">squad_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">ficheros_datos</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squad_dataset</span><span class="o">.</span><span class="n">cache_files</span><span class="p">)</span>
<span class="c1"># {&#39;train&#39;: [{&#39;filename&#39;: &#39;/Users/aitormedrano/.cache/huggingface/datasets/json/default-e3ff36a1d8fe78df/0.0.0/ab573428e7a11a7e23eebd41a2a71665ac3789ce311cbad7049572034a9bda05/json-train.arrow&#39;}],</span>
<span class="c1">#  &#39;test&#39;: [{&#39;filename&#39;: &#39;/Users/aitormedrano/.cache/huggingface/datasets/json/default-e3ff36a1d8fe78df/0.0.0/ab573428e7a11a7e23eebd41a2a71665ac3789ce311cbad7049572034a9bda05/json-test.arrow&#39;}]}</span>
</code></pre></div>
<p>Si necesitamos persistir los datos de nuevo con las transformaciones realizadas, podemos hacerlo en diferentes formatos:</p>
<ul>
<li><em>Arrow</em>: <a href="https://huggingface.co/docs/datasets/package_reference/main_classes#datasets.Dataset.save_to_disk"><code>Dataset.save_to_disk()</code></a></li>
<li>CSV: <a href="https://huggingface.co/docs/datasets/package_reference/main_classes#datasets.Dataset.to_csv"><code>Dataset.to_csv()</code></a></li>
<li>Pandas: <a href="https://huggingface.co/docs/datasets/package_reference/main_classes#datasets.Dataset.to_pandas"><code>Dataset.to_pandas()</code></a></li>
<li>JSON: <a href="https://huggingface.co/docs/datasets/package_reference/main_classes#datasets.Dataset.to_json"><code>Dataset.to_json()</code></a></li>
<li>Parquet: <a href="https://huggingface.co/docs/datasets/package_reference/main_classes#datasets.Dataset.to_parquet"><code>Dataset.to_parquet()</code></a></li>
</ul>
<p>Si por ejemplo persistimos el dataset en <em>Arrow</em>:</p>
<div class="highlight"><pre><span></span><code><span class="n">squad_dataset</span><span class="o">.</span><span class="n">save_to_disk</span><span class="p">(</span><span class="s2">&quot;squad_train_test&quot;</span><span class="p">)</span>
</code></pre></div>
<!-- tree squad_train_test -->
<p>Se creará la siguiente estructura en las carpetas, donde para cada <em>split</em> se ha creado su propia carpeta, así como un par de archivos con metadatos:</p>
<div class="highlight"><pre><span></span><code>squad_train_test
├── dataset_dict.json
├── test
│   ├── data-00000-of-00001.arrow
│   ├── dataset_info.json
│   └── state.json
└── train
    ├── data-00000-of-00001.arrow
    ├── dataset_info.json
    └── state.json
</code></pre></div>
<p>Una vez que hemos persistido el <em>dataset</em>, lo podemos volver a cargar mediante <code>load_from_disk</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_from_disk</span>
<span class="n">squad_disk</span> <span class="o">=</span> <span class="n">load_from_disk</span><span class="p">(</span><span class="s2">&quot;squad_train_test&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Si queremos persistirlos en formato CSV o JSON, por cada uno de los <em>splits</em> se crea un archivo separado. Para ello, podemos iterar sobre las claves mediante <code>DatasetDict.items()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">split</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">squad_dataset</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;squad_</span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2">.jsonl&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="publicando">Publicando</h2>
<p>Pues una vez hemos creado nuestro Dataset y lo hemos persistido en disco, el único paso que nos queda es publicar en <em>Hugging Face</em>. Para ello, en vez de subir los archivos a mano como hicimos en la sesión inicial desde el interfaz web o hacer uso de Git y copiar los archivos, desde <em>Python</em> es mucho más cómodo.</p>
<p>Previamente debemos realizar <em>login</em> para autenticarnos, tal como vimos en la sección de <a href="https://aitor-medrano.github.io/iabd/hf/hf.html#login">Login de la sesión anterior</a> y usar nuestro token de acceso (en este caso, necesitamos que nuestro token sea de escritura):</p>
<div class="highlight"><pre><span></span><code><span class="n">hf</span> <span class="n">auth</span> <span class="n">login</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Login desde un cuaderno Jupyter / Colab</p>
<p>Si trabajamos con un cuaderno de Jupyter o Colab, podemos utilizar la librería de <em>huggingface_hub</em> y al ejecutarlo, nos aparecerá una ventana donde introducir el token de acceso:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">huggingface_hub</span><span class="w"> </span><span class="kn">import</span> <span class="n">login</span>
<span class="n">login</span><span class="p">()</span>
</code></pre></div>
<p><figure style="align: center;">
    <img src="https://aitor-medrano.github.io/iabd/hf/images/03hf-hub-login-notebook.png" alt="Login desde un notebook" width="500">
    <figcaption>Login desde un notebook</figcaption>
</figure></p>
<p>También podemos hacer uso de la variable de entorno <code>HF_TOKEN</code> para almacenar el token de acceso, ya sea con un Space almacenándolo en un <a href="https://huggingface.co/docs/hub/spaces-overview#managing-secrets"><em>secret de Spaces</em></a> o en <a href="https://twitter.com/GoogleColab/status/1719798406195867814">claves privadas de Google Colab</a>.</p>
</div>
<p>Una vez autenticado, es tan sencillo como usar el método <a href="https://huggingface.co/docs/datasets/v2.18.0/en/package_reference/main_classes#datasets.Dataset.push_to_hub"><code>push_to_hub()</code></a> (si queremos publicar el <em>dataset</em> como privado, le añadimos el parámetro <code>private=True</code>):</p>
<div class="highlight"><pre><span></span><code><span class="n">midataset</span><span class="o">.</span><span class="n">push_to_hub</span><span class="p">(</span><span class="s2">&quot;aitor-medrano/midatasetpushed&quot;</span><span class="p">)</span>
<span class="c1"># midataset.push_to_hub(&quot;aitor-medrano/midatasetpushed&quot;, private=True)</span>
</code></pre></div>
<p>Si tuviéramos diferentes <em>splits</em> podríamos hacer:</p>
<div class="highlight"><pre><span></span><code><span class="n">train_dataset</span><span class="o">.</span><span class="n">push_to_hub</span><span class="p">(</span><span class="s2">&quot;aitor-medrano/midatasetpushed&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">val_dataset</span><span class="o">.</span><span class="n">push_to_hub</span><span class="p">(</span><span class="s2">&quot;aitor-medrano/midatasetpushed&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Creando el dataset card</p>
<p>Para crear el <em>dataset card</em>, podemos emplear la aplicación <a href="https://huggingface.co/spaces/huggingface/datasets-tagging">https://huggingface.co/spaces/huggingface/datasets-tagging</a> que facilita rellenar los campos e incluye recomendaciones de otros datasets.</p>
<p>También se recomienda leer la <a href="https://github.com/huggingface/datasets/blob/main/templates/README_guide.md"><em>Dataset Card Creation Guide</em></a></p>
</div>
<h2 id="datasets-multimedia">Datasets multimedia</h2>
<p>Si nuestro <em>dataset</em> va a contener elementos multimedia con imágenes o audios, podemos subir los archivos en crudo, lo cual es lo más practico en la mayoría de los casos. Si los <em>dataset</em> de imágenes o audios son muy grandes, se recomienda el formato <a href="https://github.com/webdataset/webdataset">WebDataset</a>, aunque lo más normal, es almacenar el dataset en formato <em>Parquet</em>.</p>
<p>Dicho esto, vamos a ver como trabajar con datasets que contienen elementos multimedia.</p>
<h3 id="audios">Audios</h3>
<p>Para trabajar con audios, necesitaremos instalar las librerías de audio:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>datasets<span class="o">[</span>audio<span class="o">]</span>
</code></pre></div>
<p>Una vez instalado, vamos a <a href="https://huggingface.co/docs/datasets/audio_load">cargar un <em>dataset</em> que contiene audios</a>, como es <a href="https://huggingface.co/datasets/PolyAI/minds14">PolyAI/minds14</a>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">minds</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;PolyAI/minds14&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;es-ES&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">minds</span><span class="p">)</span>
<span class="c1"># Dataset({</span>
<span class="c1">#     features: [&#39;path&#39;, &#39;audio&#39;, &#39;transcription&#39;, &#39;english_transcription&#39;, &#39;intent_class&#39;, &#39;lang_id&#39;],</span>
<span class="c1">#     num_rows: 486</span>
<span class="c1"># })</span>
</code></pre></div>
<p>El <em>dataset</em> contiene 486 archivos de audio, cada uno de los cuales va acompañado de una transcripción, una traducción al inglés y una etiqueta que indica la intención de la consulta de la persona. La columna de audio contiene los datos de audio sin procesar. Veamos uno de los ejemplos:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="err">&#39;pa</span><span class="kc">t</span><span class="err">h&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;/home/jupy</span><span class="kc">ter</span><span class="mi">-</span><span class="err">iabd/.cache/huggi</span><span class="kc">n</span><span class="err">g</span><span class="kc">fa</span><span class="err">ce/da</span><span class="kc">tasets</span><span class="err">/dow</span><span class="kc">nl</span><span class="err">oads/ex</span><span class="kc">tra</span><span class="err">c</span><span class="kc">te</span><span class="err">d/a</span><span class="mi">809</span><span class="kc">f</span><span class="mi">65</span><span class="err">b</span><span class="mf">01e</span><span class="kc">f</span><span class="mi">0</span><span class="err">d</span><span class="mi">5806</span><span class="err">ac</span><span class="mi">705</span><span class="err">a</span><span class="mi">72</span><span class="err">b</span><span class="mi">9</span><span class="err">ca</span><span class="mi">382622</span><span class="err">a</span><span class="mi">5</span><span class="err">c</span><span class="mi">03</span><span class="err">d</span><span class="mi">9</span><span class="err">a</span><span class="mi">17</span><span class="err">ad</span><span class="kc">f</span><span class="mf">1ee73</span><span class="err">de</span><span class="mi">4591650</span><span class="err">b/es</span><span class="mf">-E</span><span class="err">S~APP_ERROR/</span><span class="mi">60266571</span><span class="err">dc</span><span class="mi">3604</span><span class="kc">f</span><span class="mi">481</span><span class="err">bcb</span><span class="mi">50</span><span class="err">a.wav&#39;</span><span class="p">,</span>
<span class="hll"><span class="w"> </span><span class="err">&#39;audio&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">&#39;pa</span><span class="kc">t</span><span class="err">h&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;/home/jupy</span><span class="kc">ter</span><span class="mi">-</span><span class="err">iabd/.cache/huggi</span><span class="kc">n</span><span class="err">g</span><span class="kc">fa</span><span class="err">ce/da</span><span class="kc">tasets</span><span class="err">/dow</span><span class="kc">nl</span><span class="err">oads/ex</span><span class="kc">tra</span><span class="err">c</span><span class="kc">te</span><span class="err">d/a</span><span class="mi">809</span><span class="kc">f</span><span class="mi">65</span><span class="err">b</span><span class="mf">01e</span><span class="kc">f</span><span class="mi">0</span><span class="err">d</span><span class="mi">5806</span><span class="err">ac</span><span class="mi">705</span><span class="err">a</span><span class="mi">72</span><span class="err">b</span><span class="mi">9</span><span class="err">ca</span><span class="mi">382622</span><span class="err">a</span><span class="mi">5</span><span class="err">c</span><span class="mi">03</span><span class="err">d</span><span class="mi">9</span><span class="err">a</span><span class="mi">17</span><span class="err">ad</span><span class="kc">f</span><span class="mf">1ee73</span><span class="err">de</span><span class="mi">4591650</span><span class="err">b/es</span><span class="mf">-E</span><span class="err">S~APP_ERROR/</span><span class="mi">60266571</span><span class="err">dc</span><span class="mi">3604</span><span class="kc">f</span><span class="mi">481</span><span class="err">bcb</span><span class="mi">50</span><span class="err">a.wav&#39;</span><span class="p">,</span>
</span><span class="hll"><span class="w">    </span><span class="err">&#39;array&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">array(</span><span class="p">[</span><span class="w"> </span><span class="mf">0.</span><span class="w">        </span><span class="p">,</span><span class="w">  </span><span class="mf">0.</span><span class="w">        </span><span class="p">,</span><span class="w">  </span><span class="mf">0.</span><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="err">...</span><span class="p">,</span><span class="w">  </span><span class="mf">0.</span><span class="w">        </span><span class="p">,</span>
</span><span class="hll"><span class="w">            </span><span class="mf">-0.00024414</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00024414</span><span class="p">]</span><span class="err">)</span><span class="p">,</span>
</span><span class="w">    </span><span class="err">&#39;sampli</span><span class="kc">n</span><span class="err">g_ra</span><span class="kc">te</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">8000</span>
<span class="w"> </span><span class="p">},</span>
<span class="w"> </span><span class="err">&#39;</span><span class="kc">trans</span><span class="err">crip</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;hola</span><span class="w"> </span><span class="err">bue</span><span class="kc">nas</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">ver</span><span class="w"> </span><span class="kc">ten</span><span class="err">go</span><span class="w"> </span><span class="err">u</span><span class="kc">n</span><span class="w"> </span><span class="err">problema</span><span class="w"> </span><span class="err">co</span><span class="kc">n</span><span class="w"> </span><span class="err">vues</span><span class="kc">tra</span><span class="w"> </span><span class="err">aplicació</span><span class="kc">n</span><span class="w"> </span><span class="err">resul</span><span class="kc">ta</span><span class="w"> </span><span class="err">que</span><span class="w"> </span><span class="err">quiero</span><span class="w"> </span><span class="err">hacer</span><span class="w"> </span><span class="err">u</span><span class="kc">na</span><span class="w"> </span><span class="kc">transferen</span><span class="err">cia</span><span class="w"> </span><span class="err">ba</span><span class="kc">n</span><span class="err">caria</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">u</span><span class="kc">na</span><span class="w"> </span><span class="err">cue</span><span class="kc">nta</span><span class="w"> </span><span class="err">co</span><span class="kc">n</span><span class="err">ocida&#39;</span><span class="p">,</span>
<span class="w"> </span><span class="err">&#39;e</span><span class="kc">n</span><span class="err">glish_</span><span class="kc">trans</span><span class="err">crip</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;hello</span><span class="w"> </span><span class="err">good</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">I</span><span class="w"> </span><span class="err">have</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">problem</span><span class="w"> </span><span class="err">wi</span><span class="kc">t</span><span class="err">h</span><span class="w"> </span><span class="err">your</span><span class="w"> </span><span class="err">applica</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">i</span><span class="kc">t</span><span class="w"> </span><span class="kc">turns</span><span class="w"> </span><span class="err">ou</span><span class="kc">t</span><span class="w"> </span><span class="kc">t</span><span class="err">ha</span><span class="kc">t</span><span class="w"> </span><span class="err">I</span><span class="w"> </span><span class="err">wa</span><span class="kc">nt</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">make</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">ba</span><span class="kc">n</span><span class="err">k</span><span class="w"> </span><span class="kc">transfer</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">k</span><span class="kc">n</span><span class="err">ow</span><span class="kc">n</span><span class="w"> </span><span class="err">accou</span><span class="kc">nt</span><span class="err">&#39;</span><span class="p">,</span>
<span class="w"> </span><span class="err">&#39;i</span><span class="kc">ntent</span><span class="err">_class&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w"> </span><span class="err">&#39;la</span><span class="kc">n</span><span class="err">g_id&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">}</span>
</code></pre></div>
<p>Si nos centramos en el campo <code>audio</code>, vemos como contiene diferentes valores, los cuales forman parte de un objeto <a href="https://huggingface.co/docs/datasets/v2.19.0/en/package_reference/main_classes#datasets.Audio"><code>Audio</code></a>:</p>
<ul>
<li><code>path</code>: ruta al archivo de audio (en este ejemplo <code>*.wav</code>).</li>
<li><code>array</code>: los datos del audio decodificados, representados por un array de <em>NumPy</em></li>
<li><code>sampling_rate</code>: la frecuencia de muestreo (8,000 Hz).</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">ejemplo</span> <span class="o">=</span> <span class="n">minds</span><span class="o">.</span><span class="n">shuffle</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">id2label</span> <span class="o">=</span> <span class="n">minds</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="s2">&quot;intent_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">int2str</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">id2label</span><span class="p">(</span><span class="n">ejemplo</span><span class="p">[</span><span class="s2">&quot;intent_class&quot;</span><span class="p">])</span>
</code></pre></div>
<p>Y si queremos escuchar el audio, usando <em>Gradio</em> podemos crear un componente:</p>
<div class="highlight"><pre><span></span><code> <span class="k">with</span> <span class="n">gr</span><span class="o">.</span><span class="n">Blocks</span><span class="p">()</span> <span class="k">as</span> <span class="n">demo</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">gr</span><span class="o">.</span><span class="n">Column</span><span class="p">():</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">audio</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">demo</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">share</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>Y reproducir el audio seleccionado:</p>
<figure style="align: center;">
    <img src="https://aitor-medrano.github.io/iabd/hf/images/03hf-audio-gradio.png" alt="Reproduciendo un audio desde Gradio" width="800px">
    <figcaption>Reproduciendo un audio desde Gradio</figcaption>
</figure>

<p>Finalmente, si queremos mostrar un gráfico con el espectograma del audio, y haciendo uso de la librería <a href="https://librosa.org/doc/latest/index.html"><em>Librosa</em></a>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa.display</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">ejemplo</span><span class="p">[</span><span class="s2">&quot;audio&quot;</span><span class="p">][</span><span class="s2">&quot;array&quot;</span><span class="p">]</span>
<span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">ejemplo</span><span class="p">[</span><span class="s2">&quot;audio&quot;</span><span class="p">][</span><span class="s2">&quot;sampling_rate&quot;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">waveshow</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">)</span>
</code></pre></div>
<p>Obteniendo:</p>
<figure style="align: center;">
    <img src="https://aitor-medrano.github.io/iabd/hf/images/03hf-audio-grafico.png" alt="Representación gráfica de un audio" width="800px">
    <figcaption>Representación gráfica de un audio</figcaption>
</figure>

<h3 id="creando-un-dataset-desde-python">Creando un dataset desde Python</h3>
<p>Si queremos crear un dataset a partir de audios propios, necesitamos crear un diccionario o una lista con la ruta a nuestros audios, y a continuación, llamar al método <a href="https://huggingface.co/docs/datasets/v2.19.0/en/package_reference/main_classes#datasets.Dataset.cast_column"><code>cast_column</code></a> para transformar la columna a tipo <code>Audio</code> con las características que hemos visto antes.</p>
<p>Así pues, si tenemos los datos en un diccionario podemos hacer:</p>
<div class="highlight"><pre><span></span><code><span class="n">audio_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;audio&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;path/to/audio_1&quot;</span><span class="p">,</span> <span class="s2">&quot;path/to/audio_2&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;path/to/audio_n&quot;</span><span class="p">]})</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;audio&quot;</span><span class="p">,</span> <span class="n">Audio</span><span class="p">())</span>
</code></pre></div>
<h3 id="audiofolder">Audiofolder</h3>
<p>Otra posibilidad es crear el dataset a partir de una <a href="https://huggingface.co/docs/datasets/audio_load#audiofolder">carpeta</a> con todos los audios, y un archivo <code>metadata.csv</code> con los datos:</p>
<div class="highlight"><pre><span></span><code>folder/train/metadata.csv
folder/train/first_audio_file.mp3
folder/train/second_audio_file.mp3
folder/train/third_audio_file.mp3
</code></pre></div>
<p>Y un archivo de metadatos con:</p>
<div class="highlight"><span class="filename">metadata.csv</span><pre><span></span><code>file_name,transcription
first_audio_file.mp3,este es el texto del primer audio
second_audio_file.mp3,en el segundo audio cuento un chiste
third_audio_file.mp3,y en este audio agradezco al público sus abucheos
</code></pre></div>
<p>Y a continuación, indicamos como primer parámetro <code>autofolder</code> y con <code>data_dir</code> indicamos la carpeta que contiene los audios:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;audiofolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/folder&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="referencias">Referencias</h2>
<ul>
<li><a href="https://huggingface.co/docs/datasets/index">Documentación oficial</a> de <em>dataset</em></li>
<li>El capítulo <a href="https://huggingface.co/learn/nlp-course/chapter5/1">La librería <em>Dataset</em> del curso NLP</a> de <em>Hugging Face</em>.</li>
</ul>
<h2 id="actividades">Actividades</h2>
<ol>
<li>
<p>(<abbr title="Evalúa las mejoras en los negocios integrando convergencia tecnológica.">RAPIA.3</abbr> / <abbr title="Se han identificado sistemas que facilitan la conexión tecnológica.">CEPIA.3b</abbr>, <abbr title="Se han evaluado las características de dichos sistemas.">CEPIA.3c</abbr> / 2.5p) Siguiendo el ejemplo inicial trabajado en la sesión y sólo empleando <em>Python</em>:</p>
<ol>
<li>Descarga los datos de <em>SquadES</em> considerando que los datos remotos son los de entrenamiento y validación.</li>
<li>Con lo datos de entrenamiento, divídelos en entrenamiento y pruebas.</li>
<li>Tras ello, sobre el dataset de entrenamiento, añade una columna a los datos de entrenamiento con la cantidad de párrafos.</li>
<li>Filtra los datos de entrenamiento para que el <em>dataset</em> sólo contenga aquellos registros que tienen más de 10 párrafos.</li>
<li>Elimina la columna con la cantidad de párrafos.</li>
<li>Persiste todo el dataset en formato Parquet.</li>
<li>Finalmente, publícalo en <em>Hugging Face</em>, editando la tarjeta y poniendo un documento de ejemplo en la documentación.</li>
</ol>
</li>
<li>
<p>(<abbr title="Evalúa las mejoras en los negocios integrando convergencia tecnológica.">RAPIA.3</abbr> / <abbr title="Se han identificado sistemas que facilitan la conexión tecnológica.">CEPIA.3b</abbr>, <abbr title="Se han evaluado las características de dichos sistemas.">CEPIA.3c</abbr> / 0.5p) Carga en streaming el <em>dataset</em> de <a href="https://huggingface.co/datasets/ILSVRC/imagenet-1k">imagenet-1k</a>, y muestra la etiqueta de los primeros 5 elementos.</p>
</li>
<li>
<p>(<abbr title="Evalúa las mejoras en los negocios integrando convergencia tecnológica.">RAPIA.3</abbr> / <abbr title="Se han identificado sistemas que facilitan la conexión tecnológica.">CEPIA.3b</abbr>, <abbr title="Se han evaluado las características de dichos sistemas.">CEPIA.3c</abbr> / 1p) Tenemos un dataset con información sobre <a href="../resources/dataset_flights.csv">vuelos retrasados</a> en España y otro con información general sobre los <a href="../resources/dataset_airports.csv">aeropuertos</a>. Se pide:</p>
<ol>
<li>Une ambos <em>datasets</em> para que la información de los vuelos contengan el nombre y la ciudad de los aeropuertos.</li>
<li>Persiste los datos (sin elementos repetidos) en un <em>dataset</em> en formato <em>Arrow</em>.</li>
<li>Publícalo en <em>Hugging Face</em>.</li>
</ol>
</li>
<li>
<p>(<abbr title="Evalúa las mejoras en los negocios integrando convergencia tecnológica.">RAPIA.3</abbr> / <abbr title="Se han identificado sistemas que facilitan la conexión tecnológica.">CEPIA.3b</abbr>, <abbr title="Se han evaluado las características de dichos sistemas.">CEPIA.3c</abbr> / opcional ) Sobre la base de datos de <em>MongoDB</em> de <code>sample_training</code> disponible en los datos de muestra de <em>MongoAtlas</em>:</p>
<ol>
<li>Carga los de estados de <a href="../resources/states.js"><code>states.js</code></a>.</li>
<li>Realiza una join entre las colecciones <code>zips</code> y <code>states</code>.</li>
<li>Persiste los datos (sin elementos repetidos) en un <em>dataset</em> en formato <em>JSON</em>.</li>
<li>Publícalo en <em>Hugging Face</em>.</li>
</ol>
</li>
</ol>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pie" >
        
          
          <a href="../Datasets/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Datasets en Hugging Face">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Anterior
              </span>
              <div class="md-ellipsis">
                Datasets en Hugging Face
              </div>
            </div>
          </a>
        
        
          
          <a href="../Actividad1/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Actividad 1 - Datasets de Hugging Face">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Siguiente
              </span>
              <div class="md-ellipsis">
                Actividad 1 - Datasets de Hugging Face
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "toc.integrate", "navigation.expand", "navigation.top", "navigation.indexes", "content.tabs.link", "content.code.annotate", "content.code.copy", "navigation.footer"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>